# 第一章 计算机网络与因特网

## 1.1 什么是互联网

> 什么是因特网，从具体构成角度

* 节点：
  * 主机及其上运行的应用程序，方的
  * 路由器、交换机等网络交换设备，圆的
* 边：通信链路
  * 接入网链路：主机连接到互联网的链路
  * 主干链路：路由器间的链路

* 数以亿计的、互联的计算设备: 
  * 主机 = 端系统：电脑、手机、汽车等与互联网相连的设备，也叫端系统(end system)
  * 运行网络应用程序 
* 通信链路 
  * 光纤、同轴电缆、无线电 、卫星
  * 传输速率 = 带宽（bps） 
* 分组交换设备：转发分组 (packets) 
  * 路由器和链路层交换机
  * 端系统通过通信链路和分组交换机连接道一起

* 协议控制发送、接收消息
  * 如TCP、IP、HTTP、FTP、 PPP
* Internet：“网络的网络” 
  * 松散的层次结构，互连的ISP 
  * 公共Internet vs. 专用intranet
* Internet标准 
  * RFC: Request for comments
  * IETF: Internet Engineering  Task Forc

* 协议

  * 标准，定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接受一条报文或其他事件所采取的动作
  * 规定了语法、语义、时序（在收到报文之后，响应...）、动作（响应的时候做什么...）

* 端系统：手机、电脑、服务器等，也称为主机

  

> 什么是Internet：从服务角度

* 使用通信设施进行通信的分布式应用
  * Web、VoIP、email、分布式 游戏、电子商务、社交网络 …... 
* 通信基础设施为apps提供编 程接口（通信服务） 
  * 将发送和接收数据的apps与 互联网连接起来
  * 为app应用提供服务选择，类似于邮政服务：
    * 无连接不可靠服务
    * 面向连接的可靠服务

* 分布式应用程序
  * 涉及多个相互交换数据的端系统的应用程序，视频会议、多人游戏等

## 1.2 网络边缘

**网络结构**

* 网络边缘：
  * 主机 
  * 应用程序（客户端和服务 器） 
* 网络核心： 
  * 互连着的路由器 
  * 网络的网络 
* 接入网、物理媒体： 
  * 有线或者无线通信链

**网络边缘**

* 端系统（主机）： 
  * 运行应用程序 
  * 如Web、email 
  * 在 “网络的边缘” 
* 客户/服务器模式 
  * 客户端向服务器请求、接收服务 
  * 如Web浏览器/服务器；email 客户端/服务器 
* 对等（peer-peer ）模式 
  * 很少（甚至没有）专门的服务器 
  * 如 Gnutella、KaZaA、Emul

**网络边缘：采用网络设施的面向连接服务**

目标：在端系统之间传输数据 

* 握手：在数据传输之前 做好准备 
  * 人类协议中：你好、你好 
  * 两个通信主机之间为连接 建立状态 
* TCP – 传输控制协议（ Transmission Control  Protocol ） 
  * Internet上面向连接的服务 
* TCP 服务 [RFC 793] 
  * 可靠地、按顺序地传送数据 
    * 确认和重传
    * 发了什么，就能接收到什么
  * 流量控制 
    * 发送方不会淹没接收方
    * 发送方发的太多，而接收方的接收速度不够
  * 拥塞控制 
    * 当网络拥塞时，发送方降低发送速率
    * 很多传输都走同一条路径，这条路径就会拥塞

**网络边缘：采用基础设施的无连接服务**

目标：在端系统之间传输数据

* 无连接服务 

* UDP – 用户数据报协议 (User Datagram  Protocol) [RFC 768]:
  * 无连接
  * 不可靠数据传输 
  * 无流量控制 
  * 无拥塞控制

## 1.3 网络核心

* 网络核心：
  * 路由器的网状网络 
* 基本问题：数据怎样通过网络进行传输？ 
  * 电路交换：为每个呼叫预留一条 专有电路：如电话网 
  * 分组交换：
    * 将要传送的数据分成一个个单位： 分组 
    * 将分组从一个路由器传到相邻路由器（hop），一段段最终从源端传 到目标端
    * 每段：采用链路的最大传输能力（ 带宽）

#### 网络核心：电路交换

 端到端的资源被分配给从源端到目标端的呼叫 “call”： 

* 图中，每段链路有4条线路：
  * 该呼叫采用了上面链路的第2 个线路，右边链路的第1个线 路（piece） 
* 独享资源：不同享 
  * 每个呼叫一旦建立起来就能够 保证性能 
* 如果呼叫没有数据发送，被分配 的资源就会被浪费 (no sharing) 
* 通常被传统电话网络采用

![image-20210615202315080](C:\Users\洪明辉\AppData\Roaming\Typora\typora-user-images\image-20210615202315080.png)

为呼叫预留端-端资源 

* 链路带宽、交换能力 
* 专用资源：不共享 
* 保证性能 
* 要求建立呼叫连

网络资源（如带宽）被分成片 

* 为呼叫分配片 
* 如果某个呼叫没有数据，则其资源片处于空闲状态 （不共享） 
* 将带宽分成片  频分(Frequencydivision multiplexing) 
  * 时分(Time-division  multiplexing) 
  * 波分(Wave-division  multiplexing)

![image-20210615202631560](C:\Users\洪明辉\AppData\Roaming\Typora\typora-user-images\image-20210615202631560.png)

**计算举例**

* 在一个电路交换网络上，从主机A到主机B发送 一个640,000比特的文件需要多长时间？ 
  * 所有的链路速率为1.536 Mbps 
  * 每条链路使用时隙数为24的TDM 
  * 建立端-端的电路需500 ms 

  

  每条链路的速率（一个时间片）：1.536Mbps/24 = 64kbps 

  传输时间：640kb/64kps = 10s 

  共用时间：传输时间+建立链路时间=10s + 500ms = 10.5s

**电路交换不适合计算机之间的通信**

* 连接建立时间长 
* 计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多 
  * 即使这个呼叫没有数据传递，其所占据的片也不能够被别的呼叫使用
* 可靠性不高？

#### 网络核心 分组交换

* 分组：一台端系统要向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节。由此形成的信息包用计算机网络的术语来说称为分组（packet）
* 分组交换，在每个节点存储下来，每次只占用一条通信链路，但是存储需要时间，因此比电路交换耗时更长，还有排队时间，好处是链路共享，没有信息发送的时候，不会占用这个节点。

以分组为单位存储-转发方式

* 网络带宽资源不再分分为一个个片，传输时使用全部带宽 

* 主机之间传输的数据被分为一 个个分组 

资源共享，按需使用： 

* 存储-转发：分组每次移动一跳（ hop ） 
  * 在转发之前，节点必须收到整个分组 
  * 延迟比线路交换要大 
  * 排队时间

**排队和延迟**： 

* 如果到达速率>链路的输出速率: 
  * 分组将会排队，等待传输 
  * 如果路由器的缓存用完了，分组将会被抛弃

**网络核心的关键功能**

* 路由: 决定分组采用的源到目标的路径 
  * 路由算法

* 转发: 将分组从路由器的输 入链路转移到输出链路

**分组交换 vs. 电路交换**

* 适合于对突发式数据传输
  * 资源共享
  * 简单，不必建立呼叫
* 过度使用会造成网络拥塞：分组延时和丢失 
  * 对可靠地数据传输需要协议来约束：拥塞控制 
* Q: 怎样提供类似电路交换的服务？ 
  * 保证音频/视频应用需要的带宽 
  * 一个仍未解决的问题(chapter 7）

**分组交换网络：存储-转发**

分组交换: 分组的存储转发一段一段从源端传到目标端 ，按照有无网络层的连接，分成： 

* 数据报网络： 
  * 分组的目标地址决定下一跳 
  * 在不同的阶段，路由可以改变 
  * 类似：问路 
  * Internent
* 虚电路网络：
  * 每个分组都带标签（虚电路标识 VC ID），标签决定下一跳
  * 在呼叫建立时决定路径，在整个呼叫中路径保持不变 
  * 路由器维持每个呼叫的状态信息 
  * X.25 和ATM

**数据报(datagram) 的工作原理** 

* 在通信之前,无须建立起一个连接,有数据就传输 
* 每一个分组都独立路由(路径不一样,可能会失序)  
* 路由器根据分组的目标地址进行路由

