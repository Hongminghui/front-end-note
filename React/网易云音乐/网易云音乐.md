## 1. 初始化

* 创建项目，删除无关内容，修改图标

* 创建目录
  * assets：放css, font等资源
  * common
  * components：放公共组件
  * pages：页面组件
  * routers：存放路由映射表
  * services：本地需要的数据
  * store
  * utils
  * App.js
  * index.js

* Css重置，normalize.css
  * yarn add normalize.css, 或者在github上下载，然后手动引入
  * assets > css目录，新建base.css，导入normalize.css
  * 在index.js导入base.css
  * base.css 复制粘贴一些也是重置Css的代码
  
* 复制粘贴图片资源，很多精灵图用做背景

* 配置别名

  * yarn add @craco/craco

  * 修改package.json里scripts的值

    ```json
    "scripts": {
        "start": "craco start",
        "build": "craco build",
        "test": "craco test",
        "eject": "react-scripts eject"
    }
    ```

  * 根目录下创建craco.config.js

    @：就会找到src

    ```json
    const path = require('path');
    
    const resolve = dir => path.resolve(__dirname, dir);
    
    module.exports = {
      webpack: {
        alias: {
          '@': resolve("src"),
          'components': resolve("src/components")
        }
      }
    }
    ```



## 2. 划分页面

### 2.1 思路

页面可划分为三部分

* AppHeader

* 页面组件
* AppFooter



**Header和Footer**

Header和Footer在整个页面中都会应用，所以应该属于公共组件，在components里创建app-header，app-footer目录，在两个目录中分别创建index.js

index.js

* rmc：创建用memo包裹的函数式组件MHAppHeader, MHAppFooter
* 组件加上个人或者项目名的前缀

App.js导入两个MHAppHeader, MHAppFooter



**页面组件**

页面组件是随着路由跳转而变化的，因此要配置路由映射表

* 安装路由依赖
  * yarn add react-router-dom
  * yarn add react-router-config

* 配置路由
  * router目录下创建index.js，写路由映射表
  * pages里创建相应页面目录，导出组件，discover, friend, mine

* App.js中导入routes，用renderRoutes(routes)代替内容，用HashRouter包裹哦那个renderRoutes(routes)



**路由跳转**

编写app-header，使用navLink，增加路由跳转



### 2.2 代码

此时的主要代码：

App.js

```jsx
import React from 'react'
import { renderRoutes } from 'react-router-config'
import { HashRouter} from 'react-router-dom'

import routes from '@/router'

import MHAppHeader from '@/components/app-header'
import MHAppFooter from '@/components/app-footer'


function App() {
  return (
    <HashRouter>
      <MHAppHeader/>
      { renderRoutes(routes) }
      <MHAppFooter/>
    </HashRouter>
  );
}

export default App;

```

router > index.js

```jsx
import MHDiscover from '@/pages/discover'
import MHFriend from '@/pages/friend'
import MHMine from '@/pages/mine'

const routes = [
  {
    path: '/',
    exact: true,
    component: MHDiscover,
  },
  {
    path: '/friend',
    component: MHFriend,
  },
  {
    path: '/mine',
    component: MHMine,
  },
]

export default routes
```

app-header > index.js

```jsx
import React, { memo } from 'react'
import { NavLink } from 'react-router-dom'

export default memo(function MHAppHeader() {
  return (
    <div>
      <NavLink to='/' exact>发现音乐</NavLink>
      <NavLink to='/friend' exact>朋友</NavLink>
      <NavLink to='/mine' exact>我的</NavLink>
    </div>
  )
})

```



## 3. app-header

头部可分为两部分：

* 内容区
* 下划线



**安装，准备**

* yarn add styled-components
* app-header目录创建style.js，index.js导入

**整体结构**

* Header部分整体是一个HeaderWrapper

* 给HeaderWrapper添加高度和背景颜色
* 整体划分为内容区(content)和下划线(divider)两部分
* content添加居中的类
* divider添加高度，背景色

**content布局**

* 划分为HeaderLeft，HeaderRight

* content：flex，space-between

**HeaderLeft**

* logo，能跳转的logo，a标签，使用精灵图做背景，图片来自类sprite_01，样式来自类logo
  * a标签需要有文字，不然会报警告，加上文字后，并不需要文字显示，可以用text-indent
* select-list
  * 为避免写很多重复的NavLink，所以在services > local-data.js中创建一个headLinks数组，协商所有的文字与路由的映射，在组件中导入，并map生成jsx
  * 因为list里面前三个是路由组件，后三个是超链接，会进行页面跳转，避免在jsx部分写很多逻辑代码，所以使用showItem函数把判断的逻辑写在jsx上面
  * 结构为：select-list > select-item > a/NavLink
* 调样式
  * select-list设置行高，a标签设置为block，添加padding
  * **最后一个a标签加上hot样式，失败！**，换了一个http路径，不知道为什么又有了。
  * 给活跃的a标签添加样式，去除下划线等
  * 给活跃的a标签加上三角形图标

**HeaderRight**

* 初始化
  * yarn add antd
  * yarn add @ant-design/icons
  * assets > css > base.css中引入antd的样式

* 输入框
  * placeholder
  * 导入antd，增加搜索图标，prefix

* flex布局
* 两个div，增加创作者中心和登录



## 4. app-footer

**Footer布局**

* AppFooterWrapper 整体的容器，设置高度和背景颜色，border-top

**内容区**

* content 水平居中(wrap-v2)，
  * content中布局：划分为左右两块，flex，space-betwenn，垂直居中

**左右分区**

* FooterLeft：文字和超链接

  

* FooterRight：图片和文字



## 5. 发现音乐

项目接口：123.207.32.32:9001

路由优化，"/"路径改成重定向

* 先写静态页面，发现音乐下的路由跳转标签
* 创建相应组件
* 写路由映射表，/discover也需要重定向
* 





## 6. 推荐页面

* yarn add axios

* services里放axios.js
* 把网络请求，放在每个组件中
* 使用redux管理网络请求获得的数据，安装三个包
  * yarn add redux react-redux redux-thunk
  * 每一个页面存自己的reducer，再放到store > reducer.js里统一管理
  * store > index.js，创建store，加上中间件thunk，配置redux-devtools
  * App.js导入store，使用Provider共享store

* recommend目录下创建store，编写reducer.js，再导入到根目录下的store
* 网络请求在services里发送

* topBanners的一套流程
* redux-hooks
* 插件Project Manager
* 如果所有state都放在recommend里，并且reducer里面都是通过扩展运算符来复制一个新对象，每次都复制全部的state非常浪费性能
* 数据的不可变性，查看learn-react，语法补充
* 看看coderwhy的公众号，看看有没有react的笔记





## 10. 项目规范

* 组件加上个人或者项目前缀
* 导入文件顺序，自上而下
  * 第三方，React, memo等
  * 工具类，网络请求、actionCreators、utils、routes等
  * 页面组件，NavLink属于组件部分，所以react-router-dom也放这里

* 给每个组件编写样式时，最外层都用styled-components包裹一个div作为Wrapper

## 11. 问题记录

* 导入MHAppHeader组件时，写的路径是@components/app-header/index.js，报错：Can't resolve modules，
  * 路径去掉index.js之后就不报错了，@components/app-header/index.js

* index.js:1 Warning: React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.

  Check the render method of `Router.Consumer`.
  * router > index.js配置路由映射表时，component写成了components

* a标签 rel="noopener noreferrer"
* app-header中，hot的展示，改变图片路径就能显示了。背景图片使用相对路径不行，使用绝对路径可以显示
* 背景图片需要放在有宽高的盒子里才能显示

